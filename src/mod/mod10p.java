import java.util.*;public class mod10p{    static Scanner kb = new Scanner(System.in);    static Queue<Integer> td = new LinkedList<>();    static   String[][] arrmn = new String[kb.nextInt()][kb.nextInt()];    static int time = 0;    static  int pj = 0 ;    static int pi = 0;    public static void main(String[] args) {        final int x = kb.nextInt();        for (int i = 0; i < x ; i++) {            td.offer(kb.nextInt());        }        for (int i = 0; i <arrmn.length  ; i++) {            for (int j = 0; j <arrmn[0].length ; j++) {                arrmn[i][j]="-";            }        }        System.out.println( run(arrmn.length-1,arrmn[0].length-1,arrmn.length-1,arrmn[0].length-1));        print();    }    public static void print (){//        for (int i = 0; i <arrmn.length  ; i++) {//            for (int j = 0; j <arrmn[0].length ; j++) {//                System.out.print(arrmn[i][j]);//            }//            System.out.println();//        }////        System.out.println("_________________");        for (int i = 0; i <(arrmn.length*2)+1 ; i++) {            if(i%2==0){                for (int j = 0; j < (arrmn[0].length*2)+1; j++) {                    System.out.print(".");                }            }else {                for (int j = 0; j < (arrmn[0].length*2)+1; j++) {                  if(j%2!=0){                    if(arrmn[pi][pj]!="-"){                        System.out.print(arrmn[pi][pj]);                        pj++;                    }else {                        System.out.print(" ");                        pj++;                    }                  }else {                      System.out.print(".");                  }                }                pj=0;                pi++;            }            System.out.println();        }    }    public static int run (int x , int y , int ox , int oy){        int X = 0;        time++;        if(!td.isEmpty()){            if(time==td.peek()){                td.poll();                arrmn[x][y] = "x";                time--;                return X+run(ox,oy,x,y);            }else {                if(arrmn[x][y]=="-"){                    X++;                    arrmn[x][y]= "h";                    if(x!=ox || y != oy){                        arrmn[ox][oy]="o";                    }                    if(x-1 >= 0&& arrmn[x-1][y]=="-" ){                        return X+run(x-1, y ,x,y);                    }else if (y-1 >= 0&& arrmn[x][y-1]=="-"){                        return  X+run(x,y-1,x,y);                    }else if (x+1 < arrmn.length && arrmn[x+1][y]=="-"){                        return X+run(x+1,y,x,y);                    }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                        return X+run(x,y+1,x,y);                    }else{                        return X;                    }                }else{//not "-"                    if(arrmn[x][y]=="o"){                        arrmn[x][y]="h";                    }                    if(x>ox){                        if (y-1 >= 0 && arrmn[x][y-1]=="-"){                            return  X+run(x,y-1,x,y);                        }else if (x+1 < arrmn.length && arrmn[x+1][y]=="-"){                            return X+run(x+1,y,x,y);                        }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                            return X+run(x,y+1,x,y);                        }else{                            return X;                        }                    }else if (y>oy){                        if (x+1 < arrmn.length && arrmn[x+1][y]=="-"){                            return X+run(x+1,y,x,y);                        }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                            return X+run(x,y+1,x,y);                        }else{                            return X;                        }                    }else if(x > ox){                        if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                            return X+run(x,y+1,x,y);                        }else{                            return X;                        }                    }else {                        return X;                    }                }            }        }else{//หมดคิวที่มดถูกบี้            if(arrmn[x][y]=="-"){                X++;                arrmn[x][y]= "h";                if(x!=ox || y != oy){                    arrmn[ox][oy]="o";                }                if(x-1 >= 0&& arrmn[x-1][y]=="-"){                    return X+run(x-1, y ,x,y);//ย้อนซ้ำทาง                }else if (y-1 >= 0 && arrmn[x][y-1]=="-"){                    return  X+run(x,y-1,x,y);                }else if (x+1 < arrmn.length&& arrmn[x+1][y]=="-"){                    return X+run(x+1,y,x,y);                }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                    return X+run(x,y+1,x,y);                }else{                    return X;                }            }else{//                if(arrmn[x][y]=="o"){////                }                if(x>ox){//not "-"                    if (y-1 >= 0&& arrmn[x][y-1]=="-"){                        return  X+run(x,y-1,x,y);                    }else if (x+1 < arrmn.length && arrmn[x+1][y]=="-"){                        return X+run(x+1,y,x,y);                    }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                        return X+run(x,y+1,x,y);                    }else{                        return X;                    }                }else if (y>oy){                    if (x+1 < arrmn.length && arrmn[x+1][y]=="-" ){                        return X+run(x+1,y,x,y);                    }else if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                        return X+run(x,y+1,x,y);                    }else{                        return X;                    }                }else if(x < ox){                    if (y+1 < arrmn[0].length&& arrmn[x][y+1]=="-"){                        return X+run(x,y+1,x,y);                    }else{                        return X;                    }                }else {                    return X;                }            }        }    }}